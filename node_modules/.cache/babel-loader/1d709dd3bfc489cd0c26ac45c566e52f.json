{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.isInitializingReducer = isInitializingReducer, exports.requestingReducer = requestingReducer, exports.requestedReducer = requestedReducer, exports.timestampsReducer = timestampsReducer, exports.authReducer = authReducer, exports.authErrorReducer = authErrorReducer, exports.profileReducer = profileReducer, exports.errorsReducer = errorsReducer, exports.orderedReducer = exports.dataReducer = exports.listenersReducer = void 0;\n\nvar _assign2 = _interopRequireDefault(require(\"lodash/fp/assign\")),\n    _setWith2 = _interopRequireDefault(require(\"lodash/fp/setWith\")),\n    _isObject2 = _interopRequireDefault(require(\"lodash/isObject\")),\n    _isArray2 = _interopRequireDefault(require(\"lodash/isArray\")),\n    _get2 = _interopRequireDefault(require(\"lodash/get\")),\n    _omit2 = _interopRequireDefault(require(\"lodash/omit\")),\n    _pick2 = _interopRequireDefault(require(\"lodash/pick\")),\n    _constants = require(\"./constants\"),\n    _reducers = require(\"./utils/reducers\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || \"[object Arguments]\" === Object.prototype.toString.call(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null == arguments[i] ? {} : arguments[i],\n        ownKeys = Object.keys(source);\n    \"function\" == typeof Object.getOwnPropertySymbols && (ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n    }))), ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  return key in obj ? Object.defineProperty(obj, key, {\n    value: value,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : obj[key] = value, obj;\n}\n\nvar START = _constants.actionTypes.START,\n    SET = _constants.actionTypes.SET,\n    SET_PROFILE = _constants.actionTypes.SET_PROFILE,\n    MERGE = _constants.actionTypes.MERGE,\n    LOGIN = _constants.actionTypes.LOGIN,\n    LOGOUT = _constants.actionTypes.LOGOUT,\n    LOGIN_ERROR = _constants.actionTypes.LOGIN_ERROR,\n    CLEAR_ERRORS = _constants.actionTypes.CLEAR_ERRORS,\n    REMOVE = _constants.actionTypes.REMOVE,\n    NO_VALUE = _constants.actionTypes.NO_VALUE,\n    SET_LISTENER = _constants.actionTypes.SET_LISTENER,\n    UNSET_LISTENER = _constants.actionTypes.UNSET_LISTENER,\n    AUTHENTICATION_INIT_STARTED = _constants.actionTypes.AUTHENTICATION_INIT_STARTED,\n    AUTHENTICATION_INIT_FINISHED = _constants.actionTypes.AUTHENTICATION_INIT_FINISHED,\n    AUTH_EMPTY_CHANGE = _constants.actionTypes.AUTH_EMPTY_CHANGE,\n    AUTH_LINK_SUCCESS = _constants.actionTypes.AUTH_LINK_SUCCESS,\n    UNAUTHORIZED_ERROR = _constants.actionTypes.UNAUTHORIZED_ERROR,\n    AUTH_UPDATE_SUCCESS = _constants.actionTypes.AUTH_UPDATE_SUCCESS,\n    AUTH_RELOAD_SUCCESS = _constants.actionTypes.AUTH_RELOAD_SUCCESS,\n    PROFILE_UPDATE_SUCCESS = _constants.actionTypes.PROFILE_UPDATE_SUCCESS;\n\nfunction isInitializingReducer() {\n  var state = !!(0 < arguments.length && arguments[0] !== void 0) && arguments[0],\n      action = 1 < arguments.length ? arguments[1] : void 0;\n\n  switch (action.type) {\n    case AUTHENTICATION_INIT_STARTED:\n      return !0;\n\n    case AUTHENTICATION_INIT_FINISHED:\n      return !1;\n\n    default:\n      return state;\n  }\n}\n\nfunction requestingReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {},\n      _ref = 1 < arguments.length ? arguments[1] : void 0,\n      type = _ref.type,\n      path = _ref.path;\n\n  return type === START ? _objectSpread({}, state, _defineProperty({}, (0, _reducers.getSlashStrPath)(path), !0)) : type === NO_VALUE || type === SET ? _objectSpread({}, state, _defineProperty({}, (0, _reducers.getSlashStrPath)(path), !1)) : state;\n}\n\nfunction requestedReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {},\n      _ref2 = 1 < arguments.length ? arguments[1] : void 0,\n      type = _ref2.type,\n      path = _ref2.path;\n\n  return type === START ? _objectSpread({}, state, _defineProperty({}, (0, _reducers.getSlashStrPath)(path), !1)) : type === NO_VALUE || type === SET ? _objectSpread({}, state, _defineProperty({}, (0, _reducers.getSlashStrPath)(path), !0)) : state;\n}\n\nfunction timestampsReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {},\n      _ref3 = 1 < arguments.length ? arguments[1] : void 0,\n      type = _ref3.type,\n      path = _ref3.path;\n\n  return type === START || type === NO_VALUE || type === SET ? _objectSpread({}, state, _defineProperty({}, (0, _reducers.getSlashStrPath)(path), Date.now())) : state;\n}\n\nfunction createDataReducer() {\n  var actionKey = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : \"data\";\n  return function () {\n    var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {},\n        action = 1 < arguments.length ? arguments[1] : void 0;\n\n    switch (action.type) {\n      case SET:\n        return (0, _setWith2.default)(Object, (0, _reducers.getDotStrPath)(action.path), action[actionKey], state);\n\n      case MERGE:\n        var previousData = (0, _get2.default)(state, (0, _reducers.getDotStrPath)(action.path), {}),\n            mergedData = (0, _assign2.default)(previousData, action[actionKey]);\n        return (0, _setWith2.default)(Object, (0, _reducers.getDotStrPath)(action.path), mergedData, state);\n\n      case NO_VALUE:\n        return (0, _setWith2.default)(Object, (0, _reducers.getDotStrPath)(action.path), null, state);\n\n      case REMOVE:\n        return \"data\" === actionKey ? (0, _reducers.recursiveUnset)((0, _reducers.getDotStrPath)(action.path), state) : state;\n\n      case LOGOUT:\n        if (action.preserve) {\n          if ((0, _isArray2.default)(action.preserve)) return (0, _pick2.default)(state, action.preserve);\n          if ((0, _isObject2.default)(action.preserve)) return action.preserve[actionKey] ? (0, _reducers.preserveValuesFromState)(state, action.preserve[actionKey], {}) : {};\n          throw new Error(\"Invalid preserve parameter. It must be an Object or an Array\");\n        }\n\n        return {};\n\n      default:\n        return state;\n    }\n  };\n}\n\nfunction authReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {\n    isLoaded: !1,\n    isEmpty: !0\n  },\n      action = 1 < arguments.length ? arguments[1] : void 0;\n\n  switch (action.type) {\n    case LOGIN:\n    case AUTH_UPDATE_SUCCESS:\n      if (!action.auth) return {\n        isEmpty: !0,\n        isLoaded: !0\n      };\n      var auth = action.auth.toJSON ? action.auth.toJSON() : action.auth;\n      return action.preserve && action.preserve.auth ? (0, _reducers.preserveValuesFromState)(state, action.preserve.auth, _objectSpread({}, auth, {\n        isEmpty: !1,\n        isLoaded: !0\n      })) : _objectSpread({}, auth, {\n        isEmpty: !1,\n        isLoaded: !0\n      });\n\n    case AUTH_LINK_SUCCESS:\n    case AUTH_RELOAD_SUCCESS:\n      return action.payload ? _objectSpread({}, action.payload.toJSON ? action.payload.toJSON() : action.payload, {\n        isEmpty: !1,\n        isLoaded: !0\n      }) : {\n        isEmpty: !0,\n        isLoaded: !0\n      };\n\n    case LOGIN_ERROR:\n    case AUTH_EMPTY_CHANGE:\n    case LOGOUT:\n      return action.preserve && action.preserve.auth ? (0, _reducers.preserveValuesFromState)(state, action.preserve.auth, {\n        isLoaded: !0,\n        isEmpty: !0\n      }) : {\n        isLoaded: !0,\n        isEmpty: !0\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction authErrorReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : null,\n      action = 1 < arguments.length ? arguments[1] : void 0;\n\n  switch (action.type) {\n    case LOGIN:\n    case LOGOUT:\n      return null;\n\n    case LOGIN_ERROR:\n    case UNAUTHORIZED_ERROR:\n      return action.authError;\n\n    default:\n      return state;\n  }\n}\n\nfunction profileReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {\n    isLoaded: !1,\n    isEmpty: !0\n  },\n      action = 1 < arguments.length ? arguments[1] : void 0;\n\n  switch (action.type) {\n    case SET_PROFILE:\n      return action.profile ? _objectSpread({}, action.profile, {\n        isEmpty: !1,\n        isLoaded: !0\n      }) : _objectSpread({}, state, {\n        isEmpty: !0,\n        isLoaded: !0\n      });\n\n    case PROFILE_UPDATE_SUCCESS:\n      return Object.assign({}, state, action.payload);\n\n    case LOGIN:\n      return action.preserve && action.preserve.profile ? (0, _reducers.preserveValuesFromState)(state, action.preserve.profile, {\n        isLoaded: !0,\n        isEmpty: !0\n      }) : {\n        isEmpty: !0,\n        isLoaded: !1\n      };\n\n    case LOGOUT:\n    case AUTH_EMPTY_CHANGE:\n      return action.preserve && action.preserve.profile ? (0, _reducers.preserveValuesFromState)(state, action.preserve.profile, {\n        isLoaded: !0,\n        isEmpty: !0\n      }) : {\n        isLoaded: !0,\n        isEmpty: !0\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction errorsReducer() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : [],\n      action = 1 < arguments.length ? arguments[1] : void 0;\n\n  switch (action.type) {\n    case LOGIN_ERROR:\n    case UNAUTHORIZED_ERROR:\n      if (!(0, _isArray2.default)(state)) throw new Error(\"Errors state must be an array\");\n      return _toConsumableArray(state).concat([action.authError]);\n\n    case LOGOUT:\n    case CLEAR_ERRORS:\n      if (action.preserve && action.preserve.errors) {\n        if (\"function\" != typeof action.preserve.errors) throw new Error(\"Preserve for the errors state currently only supports functions\");\n        return state.filter(action.preserve.errors);\n      }\n\n      return [];\n\n    default:\n      return state;\n  }\n}\n\nfunction listenersById() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : {},\n      _ref4 = 1 < arguments.length ? arguments[1] : void 0,\n      type = _ref4.type,\n      path = _ref4.path,\n      payload = _ref4.payload;\n\n  return type === SET_LISTENER ? _objectSpread({}, state, _defineProperty({}, payload.id, {\n    id: payload.id,\n    path: path\n  })) : type === UNSET_LISTENER ? (0, _omit2.default)(state, [payload.id]) : state;\n}\n\nfunction allListeners() {\n  var state = 0 < arguments.length && arguments[0] !== void 0 ? arguments[0] : [],\n      _ref5 = 1 < arguments.length ? arguments[1] : void 0,\n      type = _ref5.type,\n      path = _ref5.path,\n      payload = _ref5.payload;\n\n  return type === SET_LISTENER ? _toConsumableArray(state).concat([payload.id]) : type === UNSET_LISTENER ? state.filter(function (lId) {\n    return lId !== payload.id;\n  }) : state;\n}\n\nvar listenersReducer = (0, _reducers.combineReducers)({\n  byId: listenersById,\n  allIds: allListeners\n});\nexports.listenersReducer = listenersReducer;\nvar dataReducer = createDataReducer();\nexports.dataReducer = dataReducer;\nvar orderedReducer = createDataReducer(\"ordered\");\nexports.orderedReducer = orderedReducer;","map":null,"metadata":{},"sourceType":"script"}